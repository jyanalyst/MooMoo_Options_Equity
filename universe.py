"""
Pre-defined stock universes for Options Scanner
AUTO-GENERATED by universe_builder.py on 2026-01-25 09:17:30
Next scheduled refresh: 2026-02-08

SINGLE UNIVERSE ARCHITECTURE
Quality-ranked stocks across all price ranges. No artificial tier segmentation.
Filter by available capital per position using get_wheel_universe(max_capital).

Fundamental screening criteria:
- Market Cap >$10B
- Altman Z-Score >2.0 (bankruptcy safety)
- Piotroski Score >=5 (fundamental quality)
- Debt/Equity <1.0
- ROE >10%
- Current Ratio >1.0
- FCF Margin >2%

Quality scoring (percentile-based):
- Debt/Equity (inverse): 20% weight
- Current Ratio: 15% weight
- ROE Consistency (5yr): 15% weight
- FCF Margin: 15% weight
- Revenue Growth (3yr): 10% weight
- Gross Margin: 10% weight
- Operating Margin: 10% weight
- Volume: 5% weight

Sector diversity enforced:
- Max 3 stocks per sector
- No sector >30% of universe
- Max 2 cyclicals (Energy + Basic Materials)
- Min 4 sectors

Stocks screened: 422
Quality stocks found: 142
Final universe: 31 stocks
"""

# =============================================================================
# WHEEL STRATEGY UNIVERSE (Single Quality-Focused Universe)
# Quality stocks across all price ranges - filter by capital available
# =============================================================================

WHEEL_UNIVERSE = [
    "MNST",  # Monster Beverage Corporation | Consumer Defensive | $82 | Capital: $8.2K | Score: 79.7 | Earnings: 2026-01-23
    "TSM",  # Taiwan Semiconductor Manufactu | Technology | $335 | Capital: $33.5K | Score: 79.2 | Earnings: 2026-01-23
    "V",  # Visa Inc. | Financial Services | $326 | Capital: $32.6K | Score: 78.4 | Earnings: 2026-01-23
    "MSFT",  # Microsoft Corporation | Technology | $466 | Capital: $46.6K | Score: 75.2 | Earnings: 2026-01-23
    "IBKR",  # Interactive Brokers Group, Inc | Financial Services | $78 | Capital: $7.8K | Score: 74.4 | Earnings: 2026-01-23
    "KO",  # The Coca-Cola Company | Consumer Defensive | $73 | Capital: $7.3K | Score: 71.6 | Earnings: 2026-01-23
    "GOOGL",  # Alphabet Inc. | Technology | $328 | Capital: $32.8K | Score: 70.7 | Earnings: 2026-01-23
    "EOG",  # EOG Resources, Inc. | Energy | $108 | Capital: $10.8K | Score: 67.5 | Earnings: 2026-01-23
    "LRCX",  # Lam Research Corporation | Technology | $218 | Capital: $21.8K | Score: 67.2 | Earnings: 2026-01-23
    "MRK",  # Merck & Co., Inc. | Healthcare | $108 | Capital: $10.8K | Score: 67.0 | Earnings: 2026-01-23
    "ISRG",  # Intuitive Surgical, Inc. | Healthcare | $524 | Capital: $52.4K | Score: 66.5 | Earnings: 2026-01-23
    "BAM",  # Brookfield Asset Management Lt | Financial Services | $51 | Capital: $5.1K | Score: 65.7 | Earnings: 2026-01-23
    "AME",  # AMETEK, Inc. | Industrials | $221 | Capital: $22.1K | Score: 65.7 | Earnings: 2026-01-23
    "CME",  # CME Group Inc. | Financial Services | $283 | Capital: $28.3K | Score: 64.2 | Earnings: 2026-01-23
    "MU",  # Micron Technology, Inc. | Technology | $400 | Capital: $40.0K | Score: 62.5 | Earnings: 2026-01-23
    "NFLX",  # Netflix, Inc. | Communication Services | $86 | Capital: $8.6K | Score: 62.5 | Earnings: 2026-01-23
    "PG",  # The Procter & Gamble Company | Consumer Defensive | $150 | Capital: $15.0K | Score: 61.6 | Earnings: 2026-01-23
    "SPGI",  # S&P Global Inc. | Financial Services | $534 | Capital: $53.4K | Score: 61.1 | Earnings: 2026-01-23
    "NU",  # Nu Holdings Ltd. | Financial Services | $18 | Capital: $1.8K | Score: 61.1 | Earnings: 2026-01-23
    "AMAT",  # Applied Materials, Inc. | Technology | $322 | Capital: $32.2K | Score: 59.9 | Earnings: 2026-01-23
    "AEM",  # Agnico Eagle Mines Limited | Basic Materials | $215 | Capital: $21.5K | Score: 59.7 | Earnings: 2026-01-23
    "KGC",  # Kinross Gold Corporation | Basic Materials | $37 | Capital: $3.7K | Score: 58.8 | Earnings: 2026-01-23
    "EW",  # Edwards Lifesciences Corporati | Healthcare | $84 | Capital: $8.4K | Score: 58.5 | Earnings: 2026-01-23
    "VLTO",  # Veralto Corporation | Industrials | $101 | Capital: $10.1K | Score: 56.7 | Earnings: 2026-01-23
    "DOV",  # Dover Corporation | Industrials | $207 | Capital: $20.7K | Score: 56.5 | Earnings: 2026-01-23
    "TT",  # Trane Technologies plc | Industrials | $386 | Capital: $38.6K | Score: 56.3 | Earnings: 2026-01-23
    "DFS",  # Discover Financial Services | Financial Services | $200 | Capital: $20.0K | Score: 55.0 | Earnings: 2026-01-23
    "HSY",  # The Hershey Company | Consumer Defensive | $191 | Capital: $19.1K | Score: 54.8 | Earnings: 2026-01-23
    "JNJ",  # Johnson & Johnson | Healthcare | $220 | Capital: $22.0K | Score: 54.8 | Earnings: 2026-01-23
    "STZ",  # Constellation Brands, Inc. | Consumer Defensive | $159 | Capital: $15.9K | Score: 54.7 | Earnings: 2026-01-23
    "KVUE",  # Kenvue Inc. | Consumer Defensive | $18 | Capital: $1.8K | Score: 53.1 | Earnings: 2026-01-23
]

# Capital requirement per contract (Price x 100 for 1 CSP)
CAPITAL_REQUIREMENTS = {
    "MNST": 8200,
    "TSM": 33487,
    "V": 32618,
    "MSFT": 46595,
    "IBKR": 7758,
    "KO": 7288,
    "GOOGL": 32793,
    "EOG": 10833,
    "LRCX": 21794,
    "MRK": 10818,
    "ISRG": 52399,
    "BAM": 5126,
    "AME": 22074,
    "CME": 28273,
    "MU": 39965,
    "NFLX": 8612,
    "PG": 15015,
    "SPGI": 53361,
    "NU": 1804,
    "AMAT": 32238,
    "AEM": 21454,
    "KGC": 3715,
    "EW": 8366,
    "VLTO": 10131,
    "DOV": 20671,
    "TT": 38622,
    "DFS": 20005,
    "HSY": 19120,
    "JNJ": 22014,
    "STZ": 15878,
    "KVUE": 1780,
}

# =============================================================================
# EXCLUDED TICKERS
# [PRESERVED FROM EXISTING FILE - DO NOT MODIFY]
# =============================================================================

EXCLUDED_TICKERS = [
    # Biotech with pending FDA decisions (add as needed)
    # M&A targets (add as needed)
    # Delisting candidates (add as needed)
]


# =============================================================================
# HELPER FUNCTIONS
# =============================================================================

def get_wheel_universe(max_capital: int = None) -> list:
    """
    Get Wheel universe, optionally filtered by available capital.

    Args:
        max_capital: Maximum capital per position in dollars (optional)
                    e.g., 10000 filters to stocks with price <= $100

    Returns:
        List of tickers affordable within capital constraint

    Examples:
        >>> get_wheel_universe()              # All stocks
        >>> get_wheel_universe(5000)          # Stocks up to $50
        >>> get_wheel_universe(10000)         # Stocks up to $100
        >>> get_wheel_universe(25000)         # Stocks up to $250
    """
    if max_capital is None:
        return WHEEL_UNIVERSE

    return [t for t in WHEEL_UNIVERSE if CAPITAL_REQUIREMENTS.get(t, 0) <= max_capital]


def get_affordable_stocks(max_capital: int) -> list:
    """
    Get stocks affordable within capital constraint with details.

    Args:
        max_capital: Maximum capital per position in dollars

    Returns:
        List of (ticker, capital_required) tuples sorted by capital
    """
    affordable = [
        (t, CAPITAL_REQUIREMENTS[t])
        for t in WHEEL_UNIVERSE
        if CAPITAL_REQUIREMENTS.get(t, 0) <= max_capital
    ]
    return sorted(affordable, key=lambda x: x[1])


def add_to_excluded(ticker: str):
    """Add a ticker to excluded list (runtime only)"""
    if ticker not in EXCLUDED_TICKERS:
        EXCLUDED_TICKERS.append(ticker)


def format_moomoo_symbol(ticker: str) -> str:
    """Convert ticker to MooMoo format (e.g., 'AAPL' -> 'US.AAPL')"""
    if not ticker.startswith("US."):
        return f"US.{ticker}"
    return ticker


def strip_moomoo_prefix(symbol: str) -> str:
    """Convert MooMoo format to plain ticker (e.g., 'US.AAPL' -> 'AAPL')"""
    if symbol.startswith("US."):
        return symbol[3:]
    return symbol
